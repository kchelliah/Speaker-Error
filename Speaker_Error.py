# -*- coding: utf-8 -*-
"""
Created on Tue Nov 25 13:12:07 2014

@author: kc
"""

import scipy
from numpy import *

F = 5004;           # Frequency
Nx = 57;           # Number of grid points in x direction (equal to the number of grid points in y direction)
Ny = Nx;

sur = 4;
V = np.ones(10)
V1 = np.ones(10)
E = np.ones(10)
E1 = np.ones(10)


#pv = np.ones(6,6)

path = '/mnt/sda3/Ks/SpeakerNah/F'+str(F)+'/';
j = 0;
V[j] = loadtxt(path+'AccF'+str(F)+'.txt');

j = j + 1;



##############################################################################################################################

Z1 = loadtxt(path+'pvz'+str(F)+'X0N'+str(Nx)+'.txt');
Z = np.reshape(Z1, (Nx, Ny));
V[j] = mean(Z[26,26]);  
j = j + 1;

##############################################################################################################################

Z1 = loadtxt(path+'pvz'+str(F)+'X0N'+str(Nx)+'E.txt');
Z = np.reshape(Z1, (Nx, Ny));
V[j] = mean(Z[26,26]);  
j = j + 1;

##############################################################################################################################

Z1 = loadtxt(path+'pvz'+str(F)+'X0N'+str(Nx)+'Eg.txt');
Z = np.reshape(Z1, (Nx, Ny));
V[j] = mean(Z[26,26]);  
j = j + 1;

##############################################################################################################################

Z1 = loadtxt(path+'pvz'+str(F)+'X0N'+str(Nx)+'Em.txt');
Z = np.reshape(Z1, (Nx, Ny));
V[j] = mean(Z[26,26]);  
j = j + 1;

##############################################################################################################################

Z1 = loadtxt(path+'pvz'+str(F)+'X0N'+str(Nx)+'Et.txt');
Z = np.reshape(Z1, (Nx, Ny));
V[j] = mean(Z[26,26]);  
j = j + 1;

##############################################################################################################################

Z1 = loadtxt(path+'pvz'+str(F)+'X0N'+str(Nx)+'Q.txt');
Z = np.reshape(Z1, (Nx, Ny));
V[j] = mean(Z[26,26]);  
j = j + 1;

##############################################################################################################################

Z1 = loadtxt(path+'pvz'+str(F)+'X0N'+str(Nx)+'Qg.txt');
Z = np.reshape(Z1, (Nx, Ny));
V[j] = mean(Z[26,26]);  
j = j + 1;

##############################################################################################################################

Z1 = loadtxt(path+'pvz'+str(F)+'X0N'+str(Nx)+'Qm.txt');
Z = np.reshape(Z1, (Nx, Ny));
V[j] = mean(Z[26,26]);  
j = j + 1;

##############################################################################################################################

Z1 = loadtxt(path+'pvz'+str(F)+'X0N'+str(Nx)+'Qt.txt');
Z = np.reshape(Z1, (Nx, Ny));
V[j] = mean(Z[26,26]);  


del Z;
del Z1;

##############################################################################################################################
##############################################################################################################################

Nx = 27;           # Number of grid points in x direction (equal to the number of grid points in y direction)
Ny = Nx;

j = 0;

V1[j] = V[0];
j = j+1;


##############################################################################################################################

Z1 = loadtxt(path+'pvz'+str(F)+'X0N'+str(Nx)+'.txt');
Z = np.reshape(Z1, (Nx, Ny));
V1[j] = mean(Z[13,13]);  
j = j + 1;

##############################################################################################################################

Z1 = loadtxt(path+'pvz'+str(F)+'X0N'+str(Nx)+'E.txt');
Z = np.reshape(Z1, (Nx, Ny));
V1[j] = mean(Z[13,13]);  
j = j + 1;

##############################################################################################################################

Z1 = loadtxt(path+'pvz'+str(F)+'X0N'+str(Nx)+'Eg.txt');
Z = np.reshape(Z1, (Nx, Ny));
V1[j] = mean(Z[13,13]);  
j = j + 1;

##############################################################################################################################

Z1 = loadtxt(path+'pvz'+str(F)+'X0N'+str(Nx)+'Em.txt');
Z = np.reshape(Z1, (Nx, Ny));
V1[j] = mean(Z[13,13]);  
j = j + 1;

##############################################################################################################################

Z1 = loadtxt(path+'pvz'+str(F)+'X0N'+str(Nx)+'Et.txt');
Z = np.reshape(Z1, (Nx, Ny));
V1[j] = mean(Z[13,13]);  
j = j + 1;

##############################################################################################################################

Z1 = loadtxt(path+'pvz'+str(F)+'X0N'+str(Nx)+'Q.txt');
Z = np.reshape(Z1, (Nx, Ny));
V1[j] = mean(Z[13,13]);  
j = j + 1;

##############################################################################################################################

Z1 = loadtxt(path+'pvz'+str(F)+'X0N'+str(Nx)+'Qg.txt');
Z = np.reshape(Z1, (Nx, Ny));
V1[j] = mean(Z[13,13]);  
j = j + 1;

##############################################################################################################################

Z1 = loadtxt(path+'pvz'+str(F)+'X0N'+str(Nx)+'Qm.txt');
Z = np.reshape(Z1, (Nx, Ny));
V1[j] = mean(Z[13,13]);  
j = j + 1;

##############################################################################################################################

Z1 = loadtxt(path+'pvz'+str(F)+'X0N'+str(Nx)+'Qt.txt');
Z = np.reshape(Z1, (Nx, Ny));
V1[j] = mean(Z[13,13]);  


##############################################################################################################################
##############################################################################################################################

#
#########################################################################################################################
#
########################################################################################################################


V =  20.0 * log10 (V/0.00000005);
V1 = 20.0 * log10 (V1/0.00000005);


E[1] = V[1];
E1[1] = V1[1];


for i in range(1,10):
    E[i] = [ V[i] - V[0] ] / V[i] * 100;
    E1[i] = [ V1[i] - V1[0] ] / V1[i] * 100; 


E = abs(E)



#########################################################################################################################
#
#########################################################################################################################
#
#
#
#dlmwrite(strcat(path,'F',num2str(F),'Sur',num2str(sur),'errordB.txt'),E, 'delimiter', '\t');
